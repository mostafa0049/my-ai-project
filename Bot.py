import pandas as pd
import requests

def update_global_database():
    # ุฑูุงุจุท ููุงุนุฏ ุงูุจูุงูุงุช ุงูุนุงูููุฉ (ุชุบุทู ุงูุฏูุฑูุงุช ุงููุจุฑูุ ุงูุฏุฑุฌุฉ ุงูุซุงููุฉุ ูุงูุจุทููุงุช ุงูุฃูุฑูุจูุฉ)
    # ููุงุญุธุฉ: ูุฐู ุงููุตุงุฏุฑ ูุชู ุชุญุฏูุซูุง ููููุงู ุจุงููุชุงุฆุฌ ุงููุนููุฉ
    leagues = {
        "E0": "ุงูุฏูุฑู ุงูุฅูุฌููุฒู ุงูููุชุงุฒ",
        "E1": "ุฏูุฑู ุงูุฏุฑุฌุฉ ุงูุฃููู ุงูุฅูุฌููุฒู",
        "SP1": "ุงูุฏูุฑู ุงูุฅุณุจุงูู",
        "I1": "ุงูุฏูุฑู ุงูุฅูุทุงูู",
        "D1": "ุงูุฏูุฑู ุงูุฃููุงูู",
        "F1": "ุงูุฏูุฑู ุงููุฑูุณู",
        "B1": "ุงูุฏูุฑู ุงูุจูุฌููู",
        "N1": "ุงูุฏูุฑู ุงูููููุฏู",
        "P1": "ุงูุฏูุฑู ุงูุจุฑุชุบุงูู",
        "T1": "ุงูุฏูุฑู ุงูุชุฑูู"
    }

    base_url = "https://www.football-data.co.uk/mmz4281/2425/" # ููุณู 24/25
    all_data = []

    print("๐ ุฌุงุฑู ุงุฌุชูุงุญ ููุงุนุฏ ุงูุจูุงูุงุช ุงูุฑูุงุถูุฉ ุงูุนุงูููุฉ...")

    for code, name in leagues.items():
        try:
            url = f"{base_url}{code}.csv"
            df = pd.read_csv(url)
            # ุงุฎุชูุงุฑ ุงูุฃุนูุฏุฉ ุงูุถุฑูุฑูุฉ ููุท ููุชุญููู
            df = df[['Date', 'HomeTeam', 'AwayTeam', 'FTHG', 'FTAG', 'FTR']]
            df['League'] = name
            all_data.append(df)
            print(f"โ ุชู ุฌูุจ ุจูุงูุงุช: {name}")
        except Exception as e:
            print(f"โ ุชุนุฐุฑ ุฌูุจ {name}: {e}")

    if all_data:
        # ุฏูุฌ ูู ุงูุฏูุฑูุงุช ูู ููู ูุงุญุฏ ุถุฎู
        final_db = pd.concat(all_data, ignore_index=True)
        # ุชูุธูู ุงูุจูุงูุงุช (ุฅุฒุงูุฉ ุงููุฑุงุบุงุช)
        final_db.columns = ['Date', 'Home', 'Away', 'HG', 'AG', 'Res', 'League']
        final_db.to_csv('updated_matches.csv', index=False)
        print(f"๐ ุงูุชูู ุงูุชุญุฏูุซ! ุฅุฌูุงูู ุงููุจุงุฑูุงุช ุงููุณุฌูุฉ: {len(final_db)}")
    else:
        print("โ๏ธ ูู ูุชู ุฌูุจ ุฃู ุจูุงูุงุช ุฌุฏูุฏุฉ.")

if __name__ == "__main__":
    update_global_database()
